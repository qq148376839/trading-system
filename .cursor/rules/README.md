# Cursor Rules 使用指南

## 📋 规则文件结构

```
.cursor/
└── rules/
    ├── README.md              # 本文件 - 使用指南
    ├── architecture.md       # 项目架构规范
    ├── coding-standards.md    # 编码规范
    ├── api-design.md          # API设计规范
    ├── frontend.md            # 前端开发规范
    ├── testing.md             # 测试规范
    ├── common.md              # 通用规范（安全、性能、Docker）
    ├── product-manager.md      # 产品经理模式
    ├── developer.md           # 开发角色定义
    ├── reviewer.md            # 审核角色定义
    └── tester.md              # 测试角色定义
```

## 🎯 使用方式

### 1. 默认加载

Cursor 会自动读取 `.cursorrules` 文件，该文件包含项目概述和规则导航。

### 2. 按需引用

在对话中使用 `@file:` 引用特定规则文件：

```
@file:.cursor/rules/coding-standards.md
```

### 3. 按角色激活 ⭐ 推荐使用斜杠命令

**斜杠命令（推荐）**：使用 `/命令` 格式快速激活角色

- `/dev` 或 `/developer` - 开发角色（代码编写、功能实现）
- `/review` 或 `/reviewer` - 审核角色（代码审查、质量检查）
- `/test` 或 `/tester` - 测试角色（测试用例、质量保证）
- `/pm` 或 `/product-manager` - 产品经理角色（需求分析、PRD编写）
- `/summarize` 或 `/summarizer` - 项目总结角色（文档整理、导航文件更新）⭐ 新增

**传统方式（仍支持）**：在对话中提及角色关键词，Cursor 会自动加载相应角色规则：

- **开发角色**: "开发"、"编写代码"、"实现功能"
- **审核角色**: "审查"、"检查"、"review"、"代码质量"
- **测试角色**: "测试"、"测试用例"、"质量保证"
- **产品经理角色**: 描述需求或功能时自动激活
- **项目总结角色**: "总结"、"整理文档"、"更新导航文件"、"项目总结" ⭐ 新增

## 📚 规则文件说明

### 架构和规范类

- **architecture.md** - 项目架构规范、目录结构、服务职责
- **coding-standards.md** - TypeScript编码规范、错误处理、日志规范
- **api-design.md** - RESTful API规范、Longbridge SDK使用规范
- **frontend.md** - Next.js规范、组件规范、状态管理
- **testing.md** - 单元测试规范、测试场景、测试覆盖率
- **common.md** - 安全规范、性能优化、Docker规范
- **communication.md** - ⚠️ **沟通确认规范（最重要）** - 先确认后开发原则

### 角色定义类

- **developer.md** - 开发角色定义、开发流程、工作原则
- **reviewer.md** - 代码审核角色定义、审查清单、审查原则
- **tester.md** - 测试角色定义、测试用例编写、质量保证
- **product-manager.md** - 产品经理模式、需求分析流程、PRD输出标准
- **project-summarizer.md** - 项目总结和文档整理角色、文档管理流程、导航文件更新 ⭐ 新增

## 💡 使用示例

### 示例1: 开发新功能

**使用斜杠命令（推荐）**:
```
用户: "/dev 帮我实现一个订单查询功能"

AI会自动:
1. 识别斜杠命令 /dev，加载 developer.md（开发角色）
2. 加载 coding-standards.md（编码规范）
3. 加载 api-design.md（API设计规范）
4. 根据规范提供代码实现建议
```

**传统方式（仍支持）**:
```
用户: "帮我实现一个订单查询功能"

AI会自动:
1. 识别关键词"实现"，加载 developer.md（开发角色）
2. 加载 coding-standards.md（编码规范）
3. 加载 api-design.md（API设计规范）
4. 根据规范提供代码实现建议
```

### 示例2: 代码审查

**使用斜杠命令（推荐）**:
```
用户: "/review 帮我审查这段代码"

AI会自动:
1. 识别斜杠命令 /review，加载 reviewer.md（审核角色）
2. 加载 coding-standards.md（编码规范）
3. 加载 architecture.md（架构规范）
4. 提供详细的审查反馈
```

### 示例3: 编写测试用例

**使用斜杠命令（推荐）**:
```
用户: "/test 为这个功能编写测试用例"

AI会自动:
1. 识别斜杠命令 /test，加载 tester.md（测试角色）
2. 加载 testing.md（测试规范）
3. 提供测试用例模板和示例
```

### 示例4: 需求分析

**使用斜杠命令（推荐）**:
```
用户: "/pm 我想做一个日志聚合功能"

AI会自动:
1. 识别斜杠命令 /pm，加载 product-manager.md（产品经理模式）
2. 执行需求分析流程
3. 输出标准PRD文档
```

### 示例5: 项目总结和文档整理 ⭐ 新增

**使用斜杠命令（推荐）**:
```
用户: "/summarize 总结这次对话的内容，整理到文档中"

AI会自动:
1. 识别斜杠命令 /summarize，加载 project-summarizer.md（项目总结角色）
2. 总结对话内容和成果
3. 整理内容到 docs/ 目录的适当位置
4. 同步更新 CHANGELOG.md、PROJECT_STATUS.md、README.md、CODE_MAP.md
```

## 🔄 规则更新

### 更新单个规则文件

直接编辑对应的 `.cursor/rules/*.md` 文件即可。

### 添加新规则文件

1. 在 `.cursor/rules/` 目录创建新的 `.md` 文件
2. 在 `.cursorrules` 文件中添加引用说明
3. 更新本 README.md 文件

## ⚠️ 全局约束：先确认后开发

**核心原则**: 在每次对话中，如果遇到不清楚、不确定的地方，**必须先咨询、沟通，确认清楚后再开发**。

### 必须咨询确认的情况

- ❌ **需求不明确** - 不要猜测用户意图
- ❌ **技术方案不确定** - 不要假设实现方式
- ❌ **业务逻辑模糊** - 不要自行推断业务规则
- ❌ **数据格式不明确** - 不要假设数据格式
- ❌ **集成点不清楚** - 不要假设API接口

### 咨询确认流程

1. 识别不确定点
2. 列出需要确认的问题（使用列表形式，清晰明确）
3. 等待用户确认
4. 根据确认结果进行开发

**详细说明**: 参考 `communication.md` 文件

## ⚠️ 注意事项

1. **文件大小**: 每个规则文件应该保持合理大小（建议 < 500行）
2. **引用方式**: 使用 `@file:` 引用规则文件，而不是直接复制内容
3. **角色切换**: 在对话中明确提及角色关键词，确保加载正确的角色规则
4. **规则冲突**: 如果规则之间有冲突，以更具体的规则为准
5. **先确认后开发**: ⚠️ **最重要** - 遇到不确定的地方，必须先咨询确认

## 📖 参考文档

- **项目文档**: `docs/README.md` - 项目文档索引
- **代码地图**: `CODE_MAP.md` - 代码结构说明
- **更新日志**: `CHANGELOG.md` - 项目更新记录

---

**版本**: v2.2  
**最后更新**: 2025-12-24（新增斜杠命令激活方式）

