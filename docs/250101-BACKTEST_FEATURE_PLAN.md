# å›æµ‹åŠŸèƒ½å®æ–½è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2025-12-03  
**çŠ¶æ€**: Phase 1 & 2 å·²å®Œæˆ âœ…  
**ä¼˜å…ˆçº§**: ä¸­

## ğŸ“‹ æ¦‚è¿°

å›æµ‹åŠŸèƒ½ç”¨äºéªŒè¯ç­–ç•¥çš„å†å²è¡¨ç°ï¼Œå¸®åŠ©è¯„ä¼°ç­–ç•¥ä¼˜åŒ–æ•ˆæœå’Œå‚æ•°è°ƒæ•´ã€‚

## ğŸ¯ åŠŸèƒ½éœ€æ±‚

### æ ¸å¿ƒåŠŸèƒ½

1. **å†å²æ•°æ®å›æµ‹**
   - ä½¿ç”¨å†å²Kçº¿æ•°æ®
   - ä½¿ç”¨å†å²å¸‚åœºç¯å¢ƒæ•°æ®
   - æ¨¡æ‹Ÿç­–ç•¥æ‰§è¡Œè¿‡ç¨‹

2. **æ€§èƒ½æŒ‡æ ‡è®¡ç®—**
   - æ€»æ”¶ç›Šç‡
   - æœ€å¤§å›æ’¤
   - å¤æ™®æ¯”ç‡
   - èƒœç‡
   - å¹³å‡æŒä»“æ—¶é—´
   - äº¤æ˜“æ¬¡æ•°

3. **å¯¹æ¯”åˆ†æ**
   - ä¿®å¤å‰åçš„ç­–ç•¥è¡¨ç°å¯¹æ¯”
   - ä¸åŒå‚æ•°ä¸‹çš„è¡¨ç°å¯¹æ¯”
   - ä¸åŒå¸‚åœºç¯å¢ƒä¸‹çš„è¡¨ç°å¯¹æ¯”

### æ‰©å±•åŠŸèƒ½

1. **å¯è§†åŒ–å±•ç¤º**
   - æ”¶ç›Šæ›²çº¿å›¾
   - å›æ’¤æ›²çº¿å›¾
   - äº¤æ˜“åˆ†å¸ƒå›¾

2. **å‚æ•°ä¼˜åŒ–**
   - è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜å‚æ•°
   - å‚æ•°æ•æ„Ÿæ€§åˆ†æ

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ–‡ä»¶ç»“æ„

```
api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ backtest.service.ts          # å›æµ‹æœåŠ¡
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ backtest.ts                  # å›æµ‹APIè·¯ç”±
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ backtest-engine.ts           # å›æµ‹å¼•æ“
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ backtest-runner.ts               # å›æµ‹è„šæœ¬
â””â”€â”€ __tests__/
    â””â”€â”€ backtest.test.ts                  # å›æµ‹æµ‹è¯•
```

### æ•°æ®æµç¨‹

```
å†å²æ•°æ® â†’ å›æµ‹å¼•æ“ â†’ æ¨¡æ‹Ÿæ‰§è¡Œ â†’ äº¤æ˜“è®°å½• â†’ æ€§èƒ½åˆ†æ â†’ æŠ¥å‘Šç”Ÿæˆ
```

## ğŸ’» å®ç°æ–¹æ¡ˆ

### Phase 1: ç®€å•å›æµ‹è„šæœ¬ï¼ˆ1-2å¤©ï¼‰

**ç›®æ ‡**: å®ç°åŸºæœ¬çš„å›æµ‹åŠŸèƒ½

**æ–‡ä»¶**: `api/scripts/backtest-strategy.ts`

**åŠŸèƒ½**:
- è¯»å–å†å²æ•°æ®
- æ¨¡æ‹Ÿç­–ç•¥æ‰§è¡Œ
- è®¡ç®—åŸºæœ¬æ€§èƒ½æŒ‡æ ‡
- è¾“å‡ºæ–‡æœ¬æŠ¥å‘Š

**ä½¿ç”¨æ–¹å¼**:
```bash
npm run backtest -- --strategy-id=1 --start-date=2025-01-01 --end-date=2025-12-01
```

### Phase 2: å›æµ‹æœåŠ¡ï¼ˆ3-5å¤©ï¼‰

**ç›®æ ‡**: åˆ›å»ºå®Œæ•´çš„å›æµ‹æœåŠ¡

**æ–‡ä»¶**: `api/src/services/backtest.service.ts`

**åŠŸèƒ½**:
- å›æµ‹å¼•æ“
- æ€§èƒ½åˆ†æ
- æŠ¥å‘Šç”Ÿæˆ
- ç»“æœå­˜å‚¨

**APIç«¯ç‚¹**:
- `POST /api/quant/backtest` - æ‰§è¡Œå›æµ‹
- `GET /api/quant/backtest/:id` - è·å–å›æµ‹ç»“æœ
- `GET /api/quant/backtest/:id/report` - è·å–å›æµ‹æŠ¥å‘Š

### Phase 3: å‰ç«¯å±•ç¤ºï¼ˆ2-3å¤©ï¼‰

**ç›®æ ‡**: å‰ç«¯å›æµ‹ç»“æœå±•ç¤º

**æ–‡ä»¶**: `frontend/app/quant/backtest/page.tsx`

**åŠŸèƒ½**:
- å›æµ‹é…ç½®ç•Œé¢
- å›æµ‹ç»“æœå±•ç¤º
- æ€§èƒ½å›¾è¡¨
- å¯¹æ¯”åˆ†æ

## ğŸ“Š æ•°æ®ç»“æ„

### å›æµ‹ç»“æœè¡¨

```sql
CREATE TABLE IF NOT EXISTS backtest_results (
    id SERIAL PRIMARY KEY,
    strategy_id INTEGER REFERENCES strategies(id),
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    config JSONB,  -- å›æµ‹é…ç½®
    result JSONB,  -- å›æµ‹ç»“æœ
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX IF NOT EXISTS idx_backtest_results_strategy ON backtest_results(strategy_id);
CREATE INDEX IF NOT EXISTS idx_backtest_results_dates ON backtest_results(start_date, end_date);
```

### å›æµ‹ç»“æœJSONç»“æ„

```json
{
  "totalReturn": 0.15,
  "maxDrawdown": -0.08,
  "sharpeRatio": 1.5,
  "winRate": 0.65,
  "totalTrades": 50,
  "avgHoldingTime": 4.5,
  "trades": [
    {
      "symbol": "AAPL.US",
      "entryDate": "2025-01-15",
      "exitDate": "2025-01-20",
      "entryPrice": 100.0,
      "exitPrice": 105.0,
      "pnl": 5.0,
      "pnlPercent": 5.0
    }
  ],
  "dailyReturns": [
    {
      "date": "2025-01-15",
      "return": 0.01
    }
  ]
}
```

## ğŸ§ª æµ‹è¯•è®¡åˆ’

### å•å…ƒæµ‹è¯•

- [ ] å›æµ‹å¼•æ“æµ‹è¯•
- [ ] æ€§èƒ½æŒ‡æ ‡è®¡ç®—æµ‹è¯•
- [ ] æ•°æ®åŠ è½½æµ‹è¯•

### é›†æˆæµ‹è¯•

- [ ] å®Œæ•´å›æµ‹æµç¨‹æµ‹è¯•
- [ ] APIæ¥å£æµ‹è¯•
- [ ] æ•°æ®ä¸€è‡´æ€§æµ‹è¯•

## ğŸ“ å®æ–½æ­¥éª¤

### Step 1: åˆ›å»ºå›æµ‹è„šæœ¬ï¼ˆå½“å‰å¯å®æ–½ï¼‰

1. åˆ›å»º `api/scripts/backtest-strategy.ts`
2. å®ç°æ•°æ®åŠ è½½é€»è¾‘
3. å®ç°ç­–ç•¥æ¨¡æ‹Ÿé€»è¾‘
4. å®ç°æ€§èƒ½æŒ‡æ ‡è®¡ç®—
5. å®ç°æŠ¥å‘Šç”Ÿæˆ

### Step 2: åˆ›å»ºå›æµ‹æœåŠ¡

1. åˆ›å»º `api/src/services/backtest.service.ts`
2. å®ç°å›æµ‹å¼•æ“
3. å®ç°æ€§èƒ½åˆ†æ
4. å®ç°ç»“æœå­˜å‚¨

### Step 3: åˆ›å»ºAPIæ¥å£

1. åˆ›å»º `api/src/routes/backtest.ts`
2. å®ç°å›æµ‹æ‰§è¡Œæ¥å£
3. å®ç°ç»“æœæŸ¥è¯¢æ¥å£
4. å®ç°æŠ¥å‘Šç”Ÿæˆæ¥å£

### Step 4: åˆ›å»ºå‰ç«¯ç•Œé¢

1. åˆ›å»º `frontend/app/quant/backtest/page.tsx`
2. å®ç°å›æµ‹é…ç½®ç•Œé¢
3. å®ç°ç»“æœå±•ç¤ºç•Œé¢
4. å®ç°å›¾è¡¨å±•ç¤º

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [åŠ¨æ€äº¤æ˜“ç­–ç•¥è®¾è®¡](251203-DYNAMIC_TRADING_STRATEGY_DESIGN.md)
- [åŠ¨æ€äº¤æ˜“ç­–ç•¥å®æ–½æ€»ç»“](251203-DYNAMIC_TRADING_STRATEGY_IMPLEMENTATION.md)
- [æµ‹è¯•æŒ‡å—](251203-DYNAMIC_TRADING_STRATEGY_TESTING_GUIDE.md)

---

**çŠ¶æ€**: è®¡åˆ’ä¸­ï¼Œç­‰å¾…å®æ–½  
**ä¼˜å…ˆçº§**: ä¸­ï¼ˆä¸æ˜¯æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†æœ‰åŠ©äºéªŒè¯ç­–ç•¥ï¼‰

