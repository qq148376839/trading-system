# 长桥股票交易系统 - Cursor AI 规则导航

## 📋 规则文件导航

本文件是规则导航入口，根据对话场景自动加载相应的规则文件。

### 🎯 快速使用

**默认加载**: 所有通用规则（架构、编码、API、前端等）

**按角色激活（推荐使用斜杠命令）**:
- `/dev` 或 `/developer` - 开发角色（代码编写、功能实现）
- `/review` 或 `/reviewer` - 审核角色（代码审查、质量检查）
- `/test` 或 `/tester` - 测试角色（测试用例、质量保证）
- `/pm` 或 `/product-manager` - 产品经理角色（需求分析、PRD编写）
- `/summarize` 或 `/summarizer` - 项目总结角色（文档整理、导航文件更新）⭐ 新增

**斜杠命令使用示例**:
```
/dev 帮我实现一个订单查询功能
/review 审查这段代码
/test 为这个功能编写测试用例
/pm 我想做一个日志聚合功能
/summarize 总结这次对话的内容，整理到文档中
```

**传统激活方式（仍支持）**:
- 在对话中提及角色关键词（"开发"、"审查"、"测试"等）也会自动激活

**📖 斜杠命令速查**: 查看 [COMMANDS.md](.cursor/rules/COMMANDS.md) 获取所有命令的详细说明 ⭐ 新增

**按场景激活**:
- `@file:.cursor/rules/architecture.md` - 项目架构规范
- `@file:.cursor/rules/coding-standards.md` - 编码规范
- `@file:.cursor/rules/api-design.md` - API设计规范
- `@file:.cursor/rules/frontend.md` - 前端开发规范
- `@file:.cursor/rules/testing.md` - 测试规范
- `@file:.cursor/rules/common.md` - 通用规范（安全、性能、Docker）
- `@file:.cursor/rules/communication.md` - 沟通确认规范（⚠️ 重要）

### 📁 规则文件结构

```
.cursor/
└── rules/
    ├── architecture.md      # 项目架构规范
    ├── coding-standards.md  # 编码规范
    ├── api-design.md        # API设计规范
    ├── frontend.md          # 前端开发规范
    ├── testing.md           # 测试规范
    ├── common.md            # 通用规范
    ├── communication.md     # 沟通确认规范（⚠️ 重要）
    ├── product-manager.md   # 产品经理模式
    ├── developer.md         # 开发角色定义
    ├── reviewer.md          # 审核角色定义
    ├── tester.md            # 测试角色定义
    └── project-summarizer.md # 项目总结和文档整理角色 ⭐ 新增
```

### 🎭 角色定义

#### 👨‍💻 开发角色 (Developer)
**职责**: 代码编写、功能实现、问题修复
**激活方式**: 
- ⭐ **推荐**: 使用斜杠命令 `/dev` 或 `/developer`
- 传统方式: 在对话中提及"开发"、"编写代码"、"实现功能"等关键词
**规则文件**: `@file:.cursor/rules/developer.md`
**使用示例**: `/dev 帮我实现一个订单查询功能`

#### 🔍 审核角色 (Code Reviewer)
**职责**: 代码审查、质量检查、规范验证
**激活方式**: 
- ⭐ **推荐**: 使用斜杠命令 `/review` 或 `/reviewer`
- 传统方式: 在对话中提及"审查"、"检查"、"review"、"代码质量"等关键词
**规则文件**: `@file:.cursor/rules/reviewer.md`
**使用示例**: `/review 审查这段代码`

#### 🧪 测试角色 (Tester)
**职责**: 测试用例编写、质量保证、Bug验证
**激活方式**: 
- ⭐ **推荐**: 使用斜杠命令 `/test` 或 `/tester`
- 传统方式: 在对话中提及"测试"、"测试用例"、"质量保证"等关键词
**规则文件**: `@file:.cursor/rules/tester.md`
**使用示例**: `/test 为这个功能编写测试用例`

#### 📋 产品经理角色 (Product Manager)
**职责**: 需求分析、PRD编写、功能规划
**激活方式**: 
- ⭐ **推荐**: 使用斜杠命令 `/pm` 或 `/product-manager`
- 传统方式: 在对话中描述需求或功能时自动激活
**规则文件**: `@file:.cursor/rules/product-manager.md`
**使用示例**: `/pm 我想做一个日志聚合功能`

#### 📝 项目总结角色 (Project Summarizer) ⭐ 新增
**职责**: 对话总结、文档整理、导航文件更新
**激活方式**: 
- ⭐ **推荐**: 使用斜杠命令 `/summarize` 或 `/summarizer`
- 传统方式: 在对话中提及"总结"、"整理文档"、"更新导航文件"、"项目总结"等关键词
**规则文件**: `@file:.cursor/rules/project-summarizer.md`
**使用示例**: `/summarize 总结这次对话的内容，整理到文档中`
**核心功能**:
- 总结每次对话的需求和成果
- 将内容整理到 `docs/` 目录的适当位置（features/fixes/analysis/guides/technical）
- 同步更新根目录导航文件（README.md, PROJECT_STATUS.md, CODE_MAP.md, CHANGELOG.md）
- 避免生成过多的临时文档，保持文档结构清晰

---

## ⚠️ 全局约束（Global Constraints）

### 🔍 先确认后开发原则（Clarify Before Code）

**核心原则**: 在每次对话中，如果遇到不清楚、不确定的地方，**必须先咨询、沟通，确认清楚后再开发**。

#### 必须咨询确认的情况

1. **需求不明确**
   - ❌ 不要猜测用户意图
   - ✅ 主动询问：功能的具体需求是什么？期望的行为是什么？
   - ✅ 确认：边界条件、异常处理、性能要求

2. **技术方案不确定**
   - ❌ 不要假设技术实现方式
   - ✅ 主动询问：是否有现有的实现方式？是否有技术限制？
   - ✅ 确认：技术选型、架构设计、依赖关系

3. **业务逻辑模糊**
   - ❌ 不要自行推断业务规则
   - ✅ 主动询问：业务规则是什么？有哪些特殊情况？
   - ✅ 确认：数据验证规则、状态转换逻辑、错误处理策略

4. **数据格式不明确**
   - ❌ 不要假设数据格式
   - ✅ 主动询问：输入输出格式是什么？数据结构是什么？
   - ✅ 确认：字段类型、必填项、默认值

5. **集成点不清楚**
   - ❌ 不要假设API接口
   - ✅ 主动询问：需要调用哪些API？接口规范是什么？
   - ✅ 确认：请求参数、响应格式、错误码

#### 咨询确认的标准流程

```
1. 识别不确定点
   ↓
2. 列出需要确认的问题（使用列表形式，清晰明确）
   ↓
3. 等待用户确认
   ↓
4. 根据确认结果进行开发
```

#### 咨询确认的示例格式

```
在开始实现之前，我需要确认几个问题：

1. **功能需求确认**
   - [ ] 问题1：...
   - [ ] 问题2：...

2. **技术实现确认**
   - [ ] 问题1：...
   - [ ] 问题2：...

3. **业务规则确认**
   - [ ] 问题1：...
   - [ ] 问题2：...

请确认以上问题，我会根据您的回答进行开发。
```

#### 禁止行为

- ❌ **禁止**：在不确定的情况下直接开始编码
- ❌ **禁止**：假设用户意图或业务规则
- ❌ **禁止**：使用"可能"、"应该"等不确定词汇后直接实现
- ❌ **禁止**：跳过确认环节，直接提供代码

#### 鼓励行为

- ✅ **鼓励**：主动识别不确定点
- ✅ **鼓励**：列出清晰的问题列表
- ✅ **鼓励**：等待用户确认后再行动
- ✅ **鼓励**：在确认后提供明确的实现方案

---

## 🎯 项目概述

**项目名称**: 长桥股票交易系统  
**技术栈**: Node.js + Express + TypeScript + PostgreSQL + Next.js 14  
**主要功能**: 量化交易、策略管理、订单追踪、市场数据查询

---

## 📚 参考文档

- **代码地图**: `CODE_MAP.md` - 项目中每个文件的作用和调用关系
- **技术文档**: `docs/technical/` - 系统架构和实现细节
- **功能文档**: `docs/features/` - 功能开发记录
- **用户指南**: `docs/guides/` - 使用指南和配置说明

---

**版本**: v2.3  
**最后更新**: 2025-12-24  
**规则结构**: 模块化拆分，按需加载  
**新增**: 
- 全局约束 - 先确认后开发原则
- 项目总结角色 - 文档整理和导航文件更新
- 斜杠命令系统 - 快速激活角色（/dev, /review, /test, /pm, /summarize）⭐ 最新
